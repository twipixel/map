webpackJsonp([0],{0:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a(1);var o=a(327),r=n(o),l=a(328),u=n(l);!function(){window.onload=function(){new c}}();var c=function(){function e(){i(this,e),this.init(),this.addEvent(),this.onresize()}return s(e,[{key:"init",value:function(){this.app=new r.default}},{key:"addEvent",value:function(){window.onresize=this.onresize.bind(this),window.addEventListener("keyup",this.onkeyup.bind(this)),window.addEventListener("keydown",this.onkeydown.bind(this))}},{key:"onresize",value:function(){this.app.resize()}},{key:"getIntervalFunction",value:function(e,t){function a(){t.apply(e,i),clearTimeout(this.keyIntervalId),this.keyIntervalId=setTimeout(a.bind(this),200)}for(var n=arguments.length,i=Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];return a.bind(this)}},{key:"clearInterFunction",value:function(){clearTimeout(this.keyIntervalId)}},{key:"onkeydown",value:function(e){switch(e.keyCode){case u.default.UP:this.getIntervalFunction(this.app,this.app.moveCamera,"y",-1)();break;case u.default.DOWN:this.getIntervalFunction(this.app,this.app.moveCamera,"y",1)();break;case u.default.LEFT:this.getIntervalFunction(this.app,this.app.moveCamera,"x",-1)();break;case u.default.RIGHT:this.getIntervalFunction(this.app,this.app.moveCamera,"x",1)();break;case u.default.PAGE_UP:this.getIntervalFunction(this.app,this.app.moveCamera,"z",1)();break;case u.default.PAGE_DOWN:this.getIntervalFunction(this.app,this.app.moveCamera,"z",-1)();break;case u.default.NUMBER_4:this.getIntervalFunction(this.app,this.app.rotateWorld,"y",-.01)();break;case u.default.NUMBER_6:this.getIntervalFunction(this.app,this.app.rotateWorld,"y",.01)();break;case u.default.NUMBER_8:this.getIntervalFunction(this.app,this.app.rotateWorld,"x",-.01)();break;case u.default.NUMBER_2:this.getIntervalFunction(this.app,this.app.rotateWorld,"x",.01)();break;case u.default.NUMBER_7:this.getIntervalFunction(this.app,this.app.rotateWorld,"z",-.01)();break;case u.default.NUMBER_1:this.getIntervalFunction(this.app,this.app.rotateWorld,"z",.01)();break;case u.default.NUMBER_9:this.getIntervalFunction(this.app,this.app.rotateWorld,"z",-.01)();break;case u.default.NUMBER_3:this.getIntervalFunction(this.app,this.app.rotateWorld,"z",.01)();break;case u.default.NUMPAD_ADD:this.app.zoomIn();break;case u.default.NUMPAD_SUBTRACT:this.app.zoomOut();break;case u.default.NUMPAD_ENTER:this.app.zoomOut();break;case u.default.NUMBER_0:this.app.reset();break;case u.default.W:break;case u.default.S:break;case u.default.A:break;case u.default.D:}}},{key:"onkeyup",value:function(e){switch(e.keyCode){case u.default.ESCAPE:console.clear();break;case u.default.SPACE:this.app.gui.closed?this.app.gui.open():this.app.gui.close();break;case u.default.UP:case u.default.DOWN:case u.default.LEFT:case u.default.RIGHT:case u.default.PAGE_UP:case u.default.PAGE_DOWN:case u.default.NUMBER_4:case u.default.NUMBER_6:case u.default.NUMBER_8:case u.default.NUMBER_2:case u.default.NUMBER_7:case u.default.NUMBER_1:case u.default.NUMBER_9:case u.default.NUMBER_3:case u.default.NUMPAD_ADD:case u.default.NUMPAD_SUBTRACT:case u.default.W:case u.default.S:case u.default.A:case u.default.D:this.clearInterFunction();break;case u.default.BACKSPACE:}}}]),e}()},327:function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=function(){function e(){a(this,e),this.initialize(),this.loadPbf(),this.loadVector()}return n(e,[{key:"initialize",value:function(){var e=document.getElementById("map"),t=e.getContext("2d");console.log("canvas",e),console.log("ctx",t)}},{key:"loadPbf",value:function(){this.load("./../../../asset/countries/0/0/0.pbf",function(e){var t=new Pbf(new Uint8Array(e.response));console.log("pbf",t)},function(e){console.log(e.statusText)})}},{key:"loadVector",value:function(){this.load("https://tile.mapzen.com/mapzen/vector/v1/all/13/1308/3165.mvt?api_key=vector-tiles-LM25tq4",function(e){var t=new Pbf(new Uint8Array(e.response)),a=new VectorTile(t);console.log("pbf",t),console.log("tile",a);var n=10,i=["water","landuse","roads","buildings"],s={};for(var o in a.layers)s[o]=a.layers[o].toGeoJSON();var r=[];i.forEach(function(e){if(s[e])for(var t in s[e].features)s[e].features[t].properties.label_placement||n<=13&&"buildings"==e||n<=14&&"buildings"==e&&s[e].features[t].properties.area<2e3||(s[e].features[t].layer_name=e,r.push(s[e].features[t]))}),console.log("data",s),console.log("features",r)})}},{key:"load",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=new XMLHttpRequest;n.open("GET",e),n.responseType="arraybuffer",n.onreadystatechange=function(){4==n.readyState&&200==n.status&&t&&t.call(null,n)},n.onerror=function(){a&&a.call(null,n)},n.send()}},{key:"resize",value:function(){}}]),e}();t.default=i}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbG9hZC5qcyIsIndlYnBhY2s6Ly8vLi9tYXAvcGJmL2xvYWQvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vbWFwL3BiZi9sb2FkL0FwcC5qcyJdLCJuYW1lcyI6WyJ3ZWJwYWNrSnNvbnAiLCIwIiwibW9kdWxlIiwiZXhwb3J0cyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIl9BcHAiLCJfQXBwMiIsIl9LZXlDb2RlIiwiX0tleUNvZGUyIiwid2luZG93Iiwib25sb2FkIiwiTWFpbiIsInRoaXMiLCJpbml0IiwiYWRkRXZlbnQiLCJvbnJlc2l6ZSIsInZhbHVlIiwiYXBwIiwiQXBwIiwiYmluZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJvbmtleXVwIiwib25rZXlkb3duIiwicmVzaXplIiwidGhlQXJnIiwiZnVuYyIsImludGVydmFsRnVuYyIsImFwcGx5IiwicGFyYW1zIiwiY2xlYXJUaW1lb3V0Iiwia2V5SW50ZXJ2YWxJZCIsInNldFRpbWVvdXQiLCJfbGVuIiwiYXJndW1lbnRzIiwiQXJyYXkiLCJfa2V5IiwiZXZlbnQiLCJrZXlDb2RlIiwiS2V5Q29kZSIsIlVQIiwiZ2V0SW50ZXJ2YWxGdW5jdGlvbiIsIm1vdmVDYW1lcmEiLCJET1dOIiwiTEVGVCIsIlJJR0hUIiwiUEFHRV9VUCIsIlBBR0VfRE9XTiIsIk5VTUJFUl80Iiwicm90YXRlV29ybGQiLCJOVU1CRVJfNiIsIk5VTUJFUl84IiwiTlVNQkVSXzIiLCJOVU1CRVJfNyIsIk5VTUJFUl8xIiwiTlVNQkVSXzkiLCJOVU1CRVJfMyIsIk5VTVBBRF9BREQiLCJ6b29tSW4iLCJOVU1QQURfU1VCVFJBQ1QiLCJ6b29tT3V0IiwiTlVNUEFEX0VOVEVSIiwiTlVNQkVSXzAiLCJyZXNldCIsIlciLCJTIiwiQSIsIkQiLCJFU0NBUEUiLCJjb25zb2xlIiwiY2xlYXIiLCJTUEFDRSIsImd1aSIsImNsb3NlZCIsIm9wZW4iLCJjbG9zZSIsImNsZWFySW50ZXJGdW5jdGlvbiIsIkJBQ0tTUEFDRSIsIjMyNyIsImluaXRpYWxpemUiLCJsb2FkUGJmIiwibG9hZFZlY3RvciIsImNhbnZhcyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjdHgiLCJnZXRDb250ZXh0IiwibG9nIiwibG9hZCIsInhodHRwIiwicGJmIiwiUGJmIiwiVWludDhBcnJheSIsInJlc3BvbnNlIiwic3RhdHVzVGV4dCIsInRpbGUiLCJWZWN0b3JUaWxlIiwiem9vbSIsImxheWVycyIsImRhdGEiLCJ0b0dlb0pTT04iLCJmZWF0dXJlcyIsImZvckVhY2giLCJsYXllciIsInByb3BlcnRpZXMiLCJsYWJlbF9wbGFjZW1lbnQiLCJhcmVhIiwibGF5ZXJfbmFtZSIsInB1c2giLCJ1cmwiLCJzdWNjZXNzIiwidW5kZWZpbmVkIiwiZXJyb3IiLCJYTUxIdHRwUmVxdWVzdCIsInJlc3BvbnNlVHlwZSIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlYWR5U3RhdGUiLCJzdGF0dXMiLCJjYWxsIiwib25lcnJvciIsInNlbmQiXSwibWFwcGluZ3MiOiJBQUFBQSxjQUFjLElBRVJDLEVBQ0EsU0FBVUMsRUFBUUMsRUFBU0MsR0FFaEMsWUFjQSxTQUFTQyxHQUF1QkMsR0FBTyxNQUFPQSxJQUFPQSxFQUFJQyxXQUFhRCxHQUFRRSxRQUFTRixHQUV2RixRQUFTRyxHQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFv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aUJBR25DUixHQUFRLElBQWUsYUFBVE0sR0FHZE4sR0FBUSxJQUFlLGFBQVRNLEdBQXdCSixFQUFLSSxHQUFPRixTQUFTM0csR0FBRzhHLFdBQVdFLEtBQU8sTUFFcEZQLEVBQUtJLEdBQU9GLFNBQVMzRyxHQUFHaUgsV0FBYUosRUFDckNGLEVBQVNPLEtBQUtULEVBQUtJLEdBQU9GLFNBQVMzRyxPQUtuRDJFLFFBQVFrQixJQUFJLE9BQVFZLEdBQ3BCOUIsUUFBUWtCLElBQUksV0FBWWMsUUYrTi9CbkcsSUFBSyxPQUNMZSxNQUFPLFNFM05QNEYsR0FBbUMsR0FBOUJDLEdBQThCNUUsVUFBQXZDLE9BQUEsR0FBQW9ILFNBQUE3RSxVQUFBLEdBQUFBLFVBQUEsR0FBcEIsS0FBTThFLEVBQWM5RSxVQUFBdkMsT0FBQSxHQUFBb0gsU0FBQTdFLFVBQUEsR0FBQUEsVUFBQSxHQUFOLEtBQ3hCdUQsRUFBUSxHQUFJd0IsZUFDbEJ4QixHQUFNZixLQUFLLE1BQU9tQyxHQUNsQnBCLEVBQU15QixhQUFlLGNBQ3JCekIsRUFBTTBCLG1CQUFxQixXQUNDLEdBQXBCMUIsRUFBTTJCLFlBQW1DLEtBQWhCM0IsRUFBTTRCLFFBQzNCUCxHQUNBQSxFQUFRUSxLQUFLLEtBQU03QixJQUkvQkEsRUFBTThCLFFBQVUsV0FDUlAsR0FDQUEsRUFBTU0sS0FBSyxLQUFNN0IsSUFHekJBLEVBQU0rQixVRmlPTHRILElBQUssU0FDTGUsTUFBTyxnQkFHSkUsSUFHWHZDLEdBQVFLLFFFMVVZa0MiLCJmaWxlIjoibG9hZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIndlYnBhY2tKc29ucChbMF0se1xuXG4vKioqLyAwOlxuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cdFxuXHRfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9BcHAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyNyk7XG5cdFxuXHR2YXIgX0FwcDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9BcHApO1xuXHRcblx0dmFyIF9LZXlDb2RlID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMjgpO1xuXHRcblx0dmFyIF9LZXlDb2RlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0tleUNvZGUpO1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHQoZnVuY3Rpb24gKCkge1xuXHQgICAgd2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB2YXIgbWFpbiA9IG5ldyBNYWluKCk7XG5cdCAgICB9O1xuXHR9KSgpO1xuXHRcblx0dmFyIE1haW4gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBNYWluKCkge1xuXHQgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNYWluKTtcblx0XG5cdCAgICAgICAgdGhpcy5pbml0KCk7XG5cdCAgICAgICAgdGhpcy5hZGRFdmVudCgpO1xuXHQgICAgICAgIHRoaXMub25yZXNpemUoKTtcblx0ICAgIH1cblx0XG5cdCAgICBfY3JlYXRlQ2xhc3MoTWFpbiwgW3tcblx0ICAgICAgICBrZXk6ICdpbml0Jyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHtcblx0ICAgICAgICAgICAgdGhpcy5hcHAgPSBuZXcgX0FwcDIuZGVmYXVsdCgpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdhZGRFdmVudCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZEV2ZW50KCkge1xuXHQgICAgICAgICAgICB3aW5kb3cub25yZXNpemUgPSB0aGlzLm9ucmVzaXplLmJpbmQodGhpcyk7XG5cdCAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMub25rZXl1cC5iaW5kKHRoaXMpKTtcblx0ICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLm9ua2V5ZG93bi5iaW5kKHRoaXMpKTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnb25yZXNpemUnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbnJlc2l6ZSgpIHtcblx0ICAgICAgICAgICAgdGhpcy5hcHAucmVzaXplKCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBwYXJhbSBmdW5jIHtGdW5jdGlvbn1cblx0ICAgICAgICAgKiBAcGFyYW0gcGFyYW1zXG5cdCAgICAgICAgICogQHJldHVybnMge2ludGVydmFsRnVuY31cblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnZ2V0SW50ZXJ2YWxGdW5jdGlvbicsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEludGVydmFsRnVuY3Rpb24odGhlQXJnLCBmdW5jKSB7XG5cdCAgICAgICAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBwYXJhbXMgPSBBcnJheShfbGVuID4gMiA/IF9sZW4gLSAyIDogMCksIF9rZXkgPSAyOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG5cdCAgICAgICAgICAgICAgICBwYXJhbXNbX2tleSAtIDJdID0gYXJndW1lbnRzW19rZXldO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICBmdW5jdGlvbiBpbnRlcnZhbEZ1bmMoKSB7XG5cdCAgICAgICAgICAgICAgICBmdW5jLmFwcGx5KHRoZUFyZywgcGFyYW1zKTtcblx0ICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmtleUludGVydmFsSWQpO1xuXHQgICAgICAgICAgICAgICAgdGhpcy5rZXlJbnRlcnZhbElkID0gc2V0VGltZW91dChpbnRlcnZhbEZ1bmMuYmluZCh0aGlzKSwgMjAwKTtcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIGludGVydmFsRnVuYy5iaW5kKHRoaXMpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdjbGVhckludGVyRnVuY3Rpb24nLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhckludGVyRnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmtleUludGVydmFsSWQpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdvbmtleWRvd24nLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbmtleWRvd24oZXZlbnQpIHtcblx0ICAgICAgICAgICAgc3dpdGNoIChldmVudC5rZXlDb2RlKSB7XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0LlVQOlxuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0SW50ZXJ2YWxGdW5jdGlvbih0aGlzLmFwcCwgdGhpcy5hcHAubW92ZUNhbWVyYSwgJ3knLCAtMSkoKTtcblx0ICAgICAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgICAgIGNhc2UgX0tleUNvZGUyLmRlZmF1bHQuRE9XTjpcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEludGVydmFsRnVuY3Rpb24odGhpcy5hcHAsIHRoaXMuYXBwLm1vdmVDYW1lcmEsICd5JywgMSkoKTtcblx0ICAgICAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgICAgIGNhc2UgX0tleUNvZGUyLmRlZmF1bHQuTEVGVDpcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEludGVydmFsRnVuY3Rpb24odGhpcy5hcHAsIHRoaXMuYXBwLm1vdmVDYW1lcmEsICd4JywgLTEpKCk7XG5cdCAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0LlJJR0hUOlxuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0SW50ZXJ2YWxGdW5jdGlvbih0aGlzLmFwcCwgdGhpcy5hcHAubW92ZUNhbWVyYSwgJ3gnLCAxKSgpO1xuXHQgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICAgICAgY2FzZSBfS2V5Q29kZTIuZGVmYXVsdC5QQUdFX1VQOlxuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0SW50ZXJ2YWxGdW5jdGlvbih0aGlzLmFwcCwgdGhpcy5hcHAubW92ZUNhbWVyYSwgJ3onLCAxKSgpO1xuXHQgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICAgICAgY2FzZSBfS2V5Q29kZTIuZGVmYXVsdC5QQUdFX0RPV046XG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRJbnRlcnZhbEZ1bmN0aW9uKHRoaXMuYXBwLCB0aGlzLmFwcC5tb3ZlQ2FtZXJhLCAneicsIC0xKSgpO1xuXHQgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICAgICAgY2FzZSBfS2V5Q29kZTIuZGVmYXVsdC5OVU1CRVJfNDpcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEludGVydmFsRnVuY3Rpb24odGhpcy5hcHAsIHRoaXMuYXBwLnJvdGF0ZVdvcmxkLCAneScsIC0wLjAxKSgpO1xuXHQgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICAgICAgY2FzZSBfS2V5Q29kZTIuZGVmYXVsdC5OVU1CRVJfNjpcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEludGVydmFsRnVuY3Rpb24odGhpcy5hcHAsIHRoaXMuYXBwLnJvdGF0ZVdvcmxkLCAneScsIDAuMDEpKCk7XG5cdCAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0Lk5VTUJFUl84OlxuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0SW50ZXJ2YWxGdW5jdGlvbih0aGlzLmFwcCwgdGhpcy5hcHAucm90YXRlV29ybGQsICd4JywgLTAuMDEpKCk7XG5cdCAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0Lk5VTUJFUl8yOlxuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0SW50ZXJ2YWxGdW5jdGlvbih0aGlzLmFwcCwgdGhpcy5hcHAucm90YXRlV29ybGQsICd4JywgMC4wMSkoKTtcblx0ICAgICAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgICAgIGNhc2UgX0tleUNvZGUyLmRlZmF1bHQuTlVNQkVSXzc6XG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRJbnRlcnZhbEZ1bmN0aW9uKHRoaXMuYXBwLCB0aGlzLmFwcC5yb3RhdGVXb3JsZCwgJ3onLCAtMC4wMSkoKTtcblx0ICAgICAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgICAgIGNhc2UgX0tleUNvZGUyLmRlZmF1bHQuTlVNQkVSXzE6XG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRJbnRlcnZhbEZ1bmN0aW9uKHRoaXMuYXBwLCB0aGlzLmFwcC5yb3RhdGVXb3JsZCwgJ3onLCAwLjAxKSgpO1xuXHQgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICAgICAgY2FzZSBfS2V5Q29kZTIuZGVmYXVsdC5OVU1CRVJfOTpcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEludGVydmFsRnVuY3Rpb24odGhpcy5hcHAsIHRoaXMuYXBwLnJvdGF0ZVdvcmxkLCAneicsIC0wLjAxKSgpO1xuXHQgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICAgICAgY2FzZSBfS2V5Q29kZTIuZGVmYXVsdC5OVU1CRVJfMzpcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEludGVydmFsRnVuY3Rpb24odGhpcy5hcHAsIHRoaXMuYXBwLnJvdGF0ZVdvcmxkLCAneicsIDAuMDEpKCk7XG5cdCAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0Lk5VTVBBRF9BREQ6XG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAuem9vbUluKCk7XG5cdCAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0Lk5VTVBBRF9TVUJUUkFDVDpcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcC56b29tT3V0KCk7XG5cdCAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0Lk5VTVBBRF9FTlRFUjpcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcC56b29tT3V0KCk7XG5cdCAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0Lk5VTUJFUl8wOlxuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLnJlc2V0KCk7XG5cdCAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0Llc6XG5cdCAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0LlM6XG5cdCAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0LkE6XG5cdCAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0LkQ6XG5cdCAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnb25rZXl1cCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9ua2V5dXAoZXZlbnQpIHtcblx0ICAgICAgICAgICAgc3dpdGNoIChldmVudC5rZXlDb2RlKSB7XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0LkVTQ0FQRTpcblx0ICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmNsZWFyKCk7XG5cdCAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdFxuXHQgICAgICAgICAgICAgICAgY2FzZSBfS2V5Q29kZTIuZGVmYXVsdC5TUEFDRTpcblx0ICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hcHAuZ3VpLmNsb3NlZCkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcC5ndWkub3BlbigpO1xuXHQgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLmd1aS5jbG9zZSgpO1xuXHQgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICBicmVhaztcblx0XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0LlVQOlxuXHQgICAgICAgICAgICAgICAgY2FzZSBfS2V5Q29kZTIuZGVmYXVsdC5ET1dOOlxuXHQgICAgICAgICAgICAgICAgY2FzZSBfS2V5Q29kZTIuZGVmYXVsdC5MRUZUOlxuXHQgICAgICAgICAgICAgICAgY2FzZSBfS2V5Q29kZTIuZGVmYXVsdC5SSUdIVDpcblx0ICAgICAgICAgICAgICAgIGNhc2UgX0tleUNvZGUyLmRlZmF1bHQuUEFHRV9VUDpcblx0ICAgICAgICAgICAgICAgIGNhc2UgX0tleUNvZGUyLmRlZmF1bHQuUEFHRV9ET1dOOlxuXHQgICAgICAgICAgICAgICAgY2FzZSBfS2V5Q29kZTIuZGVmYXVsdC5OVU1CRVJfNDpcblx0ICAgICAgICAgICAgICAgIGNhc2UgX0tleUNvZGUyLmRlZmF1bHQuTlVNQkVSXzY6XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0Lk5VTUJFUl84OlxuXHQgICAgICAgICAgICAgICAgY2FzZSBfS2V5Q29kZTIuZGVmYXVsdC5OVU1CRVJfMjpcblx0ICAgICAgICAgICAgICAgIGNhc2UgX0tleUNvZGUyLmRlZmF1bHQuTlVNQkVSXzc6XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0Lk5VTUJFUl8xOlxuXHQgICAgICAgICAgICAgICAgY2FzZSBfS2V5Q29kZTIuZGVmYXVsdC5OVU1CRVJfOTpcblx0ICAgICAgICAgICAgICAgIGNhc2UgX0tleUNvZGUyLmRlZmF1bHQuTlVNQkVSXzM6XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0Lk5VTVBBRF9BREQ6XG5cdCAgICAgICAgICAgICAgICBjYXNlIF9LZXlDb2RlMi5kZWZhdWx0Lk5VTVBBRF9TVUJUUkFDVDpcblx0ICAgICAgICAgICAgICAgIGNhc2UgX0tleUNvZGUyLmRlZmF1bHQuVzpcblx0ICAgICAgICAgICAgICAgIGNhc2UgX0tleUNvZGUyLmRlZmF1bHQuUzpcblx0ICAgICAgICAgICAgICAgIGNhc2UgX0tleUNvZGUyLmRlZmF1bHQuQTpcblx0ICAgICAgICAgICAgICAgIGNhc2UgX0tleUNvZGUyLmRlZmF1bHQuRDpcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFySW50ZXJGdW5jdGlvbigpO1xuXHQgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHRcblx0ICAgICAgICAgICAgICAgIGNhc2UgX0tleUNvZGUyLmRlZmF1bHQuQkFDS1NQQUNFOlxuXHQgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgfV0pO1xuXG5cdCAgICByZXR1cm4gTWFpbjtcblx0fSgpO1xuXG4vKioqLyB9KSxcblxuLyoqKi8gMzI3OlxuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdHZhciBBcHAgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBBcHAoKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFwcCk7XG5cdFxuXHQgICAgICAgIHRoaXMuaW5pdGlhbGl6ZSgpO1xuXHQgICAgICAgIHRoaXMubG9hZFBiZigpO1xuXHQgICAgICAgIHRoaXMubG9hZFZlY3RvcigpO1xuXHQgICAgfVxuXHRcblx0ICAgIF9jcmVhdGVDbGFzcyhBcHAsIFt7XG5cdCAgICAgICAga2V5OiAnaW5pdGlhbGl6ZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemUoKSB7XG5cdCAgICAgICAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyk7XG5cdCAgICAgICAgICAgIHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblx0ICAgICAgICAgICAgY29uc29sZS5sb2coJ2NhbnZhcycsIGNhbnZhcyk7XG5cdCAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjdHgnLCBjdHgpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdsb2FkUGJmJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZFBiZigpIHtcblx0ICAgICAgICAgICAgdGhpcy5sb2FkKCcuLy4uLy4uLy4uL2Fzc2V0L2NvdW50cmllcy8wLzAvMC5wYmYnLCBmdW5jdGlvbiAoeGh0dHApIHtcblx0ICAgICAgICAgICAgICAgIHZhciBwYmYgPSBuZXcgUGJmKG5ldyBVaW50OEFycmF5KHhodHRwLnJlc3BvbnNlKSk7XG5cdCAgICAgICAgICAgICAgICAvLyBjb25zdCB0aWxlID0gbmV3IFZlY3RvclRpbGUocGJmKTtcblx0ICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdwYmYnLCBwYmYpO1xuXHQgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3RpbGUnLCB0aWxlKTtcblx0ICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHhodHRwKSB7XG5cdCAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh4aHR0cC5zdGF0dXNUZXh0KTtcblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2xvYWRWZWN0b3InLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkVmVjdG9yKCkge1xuXHQgICAgICAgICAgICB0aGlzLmxvYWQoJ2h0dHBzOi8vdGlsZS5tYXB6ZW4uY29tL21hcHplbi92ZWN0b3IvdjEvYWxsLzEzLzEzMDgvMzE2NS5tdnQ/YXBpX2tleT12ZWN0b3ItdGlsZXMtTE0yNXRxNCcsXG5cdCAgICAgICAgICAgIC8vICdodHRwczovL3RpbGUubWFwemVuLmNvbS9tYXB6ZW4vdmVjdG9yL3YxL2FsbC8xMy8xMzA5LzMxNjUubXZ0P2FwaV9rZXk9dmVjdG9yLXRpbGVzLUxNMjV0cTQnLFxuXHQgICAgICAgICAgICAvLyAnaHR0cHM6Ly90aWxlLm1hcHplbi5jb20vbWFwemVuL3ZlY3Rvci92MS9hbGwvMTMvMTMxMC8zMTY1Lm12dD9hcGlfa2V5PXZlY3Rvci10aWxlcy1MTTI1dHE0Jyxcblx0ICAgICAgICAgICAgLy8gJ2h0dHBzOi8vdGlsZS5tYXB6ZW4uY29tL21hcHplbi92ZWN0b3IvdjEvYWxsLzEzLzEzMTEvMzE2NS5tdnQ/YXBpX2tleT12ZWN0b3ItdGlsZXMtTE0yNXRxNCcsXG5cdCAgICAgICAgICAgIC8vICdodHRwczovL3RpbGUubWFwemVuLmNvbS9tYXB6ZW4vdmVjdG9yL3YxL2FsbC8xMy8xMzA4LzMxNjYubXZ0P2FwaV9rZXk9dmVjdG9yLXRpbGVzLUxNMjV0cTQnLFxuXHQgICAgICAgICAgICAvLyAnaHR0cHM6Ly90aWxlLm1hcHplbi5jb20vbWFwemVuL3ZlY3Rvci92MS9hbGwvMTMvMTMwOS8zMTY2Lm12dD9hcGlfa2V5PXZlY3Rvci10aWxlcy1MTTI1dHE0Jyxcblx0ICAgICAgICAgICAgLy8gJ2h0dHBzOi8vdGlsZS5tYXB6ZW4uY29tL21hcHplbi92ZWN0b3IvdjEvYWxsLzEzLzEzMTAvMzE2Ni5tdnQ/YXBpX2tleT12ZWN0b3ItdGlsZXMtTE0yNXRxNCcsXG5cdCAgICAgICAgICAgIC8vICdodHRwczovL3RpbGUubWFwemVuLmNvbS9tYXB6ZW4vdmVjdG9yL3YxL2FsbC8xMy8xMzExLzMxNjYubXZ0P2FwaV9rZXk9dmVjdG9yLXRpbGVzLUxNMjV0cTQnLFxuXHQgICAgICAgICAgICAvLyAnaHR0cHM6Ly90aWxlLm1hcHplbi5jb20vbWFwemVuL3ZlY3Rvci92MS9hbGwvMTMvMTMwOC8zMTY3Lm12dD9hcGlfa2V5PXZlY3Rvci10aWxlcy1MTTI1dHE0Jyxcblx0ICAgICAgICAgICAgLy8gJ2h0dHBzOi8vdGlsZS5tYXB6ZW4uY29tL21hcHplbi92ZWN0b3IvdjEvYWxsLzEzLzEzMDkvMzE2Ny5tdnQ/YXBpX2tleT12ZWN0b3ItdGlsZXMtTE0yNXRxNCcsXG5cdCAgICAgICAgICAgIGZ1bmN0aW9uICh4aHR0cCkge1xuXHQgICAgICAgICAgICAgICAgdmFyIHBiZiA9IG5ldyBQYmYobmV3IFVpbnQ4QXJyYXkoeGh0dHAucmVzcG9uc2UpKTtcblx0ICAgICAgICAgICAgICAgIHZhciB0aWxlID0gbmV3IFZlY3RvclRpbGUocGJmKTtcblx0ICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdwYmYnLCBwYmYpO1xuXHQgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3RpbGUnLCB0aWxlKTtcblx0XG5cdCAgICAgICAgICAgICAgICB2YXIgem9vbSA9IDEwO1xuXHQgICAgICAgICAgICAgICAgdmFyIGxheWVycyA9IFsnd2F0ZXInLCAnbGFuZHVzZScsICdyb2FkcycsICdidWlsZGluZ3MnXTtcblx0XG5cdCAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHt9O1xuXHQgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHRpbGUubGF5ZXJzKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgZGF0YVtrZXldID0gdGlsZS5sYXllcnNba2V5XS50b0dlb0pTT04oKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgICAgICB2YXIgZmVhdHVyZXMgPSBbXTtcblx0XG5cdCAgICAgICAgICAgICAgICBsYXllcnMuZm9yRWFjaChmdW5jdGlvbiAobGF5ZXIpIHtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVtsYXllcl0pIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBkYXRhW2xheWVyXS5mZWF0dXJlcykge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG9uJ3QgaW5jbHVkZSBhbnkgbGFiZWwgcGxhY2VtZW50IHBvaW50c1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFbbGF5ZXJdLmZlYXR1cmVzW2ldLnByb3BlcnRpZXMubGFiZWxfcGxhY2VtZW50KSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG9uJ3Qgc2hvdyBsYXJnZSBidWlsZGluZ3MgYXQgejEzIG9yIGJlbG93LlxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHpvb20gPD0gMTMgJiYgbGF5ZXIgPT0gJ2J1aWxkaW5ncycpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEb24ndCBzaG93IHNtYWxsIGJ1aWxkaW5ncyBhdCB6MTQgb3IgYmVsb3cuXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoem9vbSA8PSAxNCAmJiBsYXllciA9PSAnYnVpbGRpbmdzJyAmJiBkYXRhW2xheWVyXS5mZWF0dXJlc1tpXS5wcm9wZXJ0aWVzLmFyZWEgPCAyMDAwKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtsYXllcl0uZmVhdHVyZXNbaV0ubGF5ZXJfbmFtZSA9IGxheWVyO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVyZXMucHVzaChkYXRhW2xheWVyXS5mZWF0dXJlc1tpXSk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkYXRhJywgZGF0YSk7XG5cdCAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZmVhdHVyZXMnLCBmZWF0dXJlcyk7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdsb2FkJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZCh1cmwpIHtcblx0ICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IG51bGw7XG5cdCAgICAgICAgICAgIHZhciBlcnJvciA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogbnVsbDtcblx0XG5cdCAgICAgICAgICAgIHZhciB4aHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXHQgICAgICAgICAgICB4aHR0cC5vcGVuKCdHRVQnLCB1cmwpO1xuXHQgICAgICAgICAgICB4aHR0cC5yZXNwb25zZVR5cGUgPSAnYXJyYXlidWZmZXInO1xuXHQgICAgICAgICAgICB4aHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICBpZiAoeGh0dHAucmVhZHlTdGF0ZSA9PSA0ICYmIHhodHRwLnN0YXR1cyA9PSAyMDApIHtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAoc3VjY2Vzcykge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzLmNhbGwobnVsbCwgeGh0dHApO1xuXHQgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfTtcblx0ICAgICAgICAgICAgeGh0dHAub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgIGlmIChlcnJvcikge1xuXHQgICAgICAgICAgICAgICAgICAgIGVycm9yLmNhbGwobnVsbCwgeGh0dHApO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9O1xuXHQgICAgICAgICAgICB4aHR0cC5zZW5kKCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3Jlc2l6ZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2l6ZSgpIHt9XG5cdCAgICB9XSk7XG5cdFxuXHQgICAgcmV0dXJuIEFwcDtcblx0fSgpO1xuXHRcblx0ZXhwb3J0cy5kZWZhdWx0ID0gQXBwO1xuXG4vKioqLyB9KVxuXG59KTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbG9hZC5qcyIsImltcG9ydCAnYmFiZWwtcG9seWZpbGwnO1xuaW1wb3J0IEFwcCBmcm9tICcuL0FwcCc7XG5pbXBvcnQgS2V5Q29kZSBmcm9tICcuLi8uLi8uLi9zcmMvY29uc3RzL0tleUNvZGUnO1xuXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgd2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG1haW4gPSBuZXcgTWFpbigpO1xuICAgIH1cbn0oKSk7XG5cbmNsYXNzIE1haW4ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmluaXQoKTtcbiAgICAgICAgdGhpcy5hZGRFdmVudCgpO1xuICAgICAgICB0aGlzLm9ucmVzaXplKCk7XG4gICAgfVxuXG4gICAgaW5pdCgpIHtcbiAgICAgICAgdGhpcy5hcHAgPSBuZXcgQXBwKCk7XG4gICAgfVxuXG4gICAgYWRkRXZlbnQoKSB7XG4gICAgICAgIHdpbmRvdy5vbnJlc2l6ZSA9IHRoaXMub25yZXNpemUuYmluZCh0aGlzKTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5vbmtleXVwLmJpbmQodGhpcykpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMub25rZXlkb3duLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIG9ucmVzaXplKCkge1xuICAgICAgICB0aGlzLmFwcC5yZXNpemUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSBmdW5jIHtGdW5jdGlvbn1cbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICogQHJldHVybnMge2ludGVydmFsRnVuY31cbiAgICAgKi9cbiAgICBnZXRJbnRlcnZhbEZ1bmN0aW9uKHRoZUFyZywgZnVuYywgLi4ucGFyYW1zKSB7XG4gICAgICAgIGZ1bmN0aW9uIGludGVydmFsRnVuYygpIHtcbiAgICAgICAgICAgIGZ1bmMuYXBwbHkodGhlQXJnLCBwYXJhbXMpO1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMua2V5SW50ZXJ2YWxJZCk7XG4gICAgICAgICAgICB0aGlzLmtleUludGVydmFsSWQgPSBzZXRUaW1lb3V0KGludGVydmFsRnVuYy5iaW5kKHRoaXMpLCAyMDApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGludGVydmFsRnVuYy5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIGNsZWFySW50ZXJGdW5jdGlvbigpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMua2V5SW50ZXJ2YWxJZCk7XG4gICAgfVxuXG4gICAgb25rZXlkb3duKGV2ZW50KSB7XG4gICAgICAgIHN3aXRjaCAoZXZlbnQua2V5Q29kZSkge1xuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLlVQOlxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0SW50ZXJ2YWxGdW5jdGlvbih0aGlzLmFwcCwgdGhpcy5hcHAubW92ZUNhbWVyYSwgJ3knLCAtMSkoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgS2V5Q29kZS5ET1dOOlxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0SW50ZXJ2YWxGdW5jdGlvbih0aGlzLmFwcCwgdGhpcy5hcHAubW92ZUNhbWVyYSwgJ3knLCAxKSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLkxFRlQ6XG4gICAgICAgICAgICAgICAgdGhpcy5nZXRJbnRlcnZhbEZ1bmN0aW9uKHRoaXMuYXBwLCB0aGlzLmFwcC5tb3ZlQ2FtZXJhLCAneCcsIC0xKSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLlJJR0hUOlxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0SW50ZXJ2YWxGdW5jdGlvbih0aGlzLmFwcCwgdGhpcy5hcHAubW92ZUNhbWVyYSwgJ3gnLCAxKSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLlBBR0VfVVA6XG4gICAgICAgICAgICAgICAgdGhpcy5nZXRJbnRlcnZhbEZ1bmN0aW9uKHRoaXMuYXBwLCB0aGlzLmFwcC5tb3ZlQ2FtZXJhLCAneicsIDEpKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEtleUNvZGUuUEFHRV9ET1dOOlxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0SW50ZXJ2YWxGdW5jdGlvbih0aGlzLmFwcCwgdGhpcy5hcHAubW92ZUNhbWVyYSwgJ3onLCAtMSkoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgS2V5Q29kZS5OVU1CRVJfNDpcbiAgICAgICAgICAgICAgICB0aGlzLmdldEludGVydmFsRnVuY3Rpb24odGhpcy5hcHAsIHRoaXMuYXBwLnJvdGF0ZVdvcmxkLCAneScsIC0wLjAxKSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLk5VTUJFUl82OlxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0SW50ZXJ2YWxGdW5jdGlvbih0aGlzLmFwcCwgdGhpcy5hcHAucm90YXRlV29ybGQsICd5JywgMC4wMSkoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgS2V5Q29kZS5OVU1CRVJfODpcbiAgICAgICAgICAgICAgICB0aGlzLmdldEludGVydmFsRnVuY3Rpb24odGhpcy5hcHAsIHRoaXMuYXBwLnJvdGF0ZVdvcmxkLCAneCcsIC0wLjAxKSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLk5VTUJFUl8yOlxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0SW50ZXJ2YWxGdW5jdGlvbih0aGlzLmFwcCwgdGhpcy5hcHAucm90YXRlV29ybGQsICd4JywgMC4wMSkoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgS2V5Q29kZS5OVU1CRVJfNzpcbiAgICAgICAgICAgICAgICB0aGlzLmdldEludGVydmFsRnVuY3Rpb24odGhpcy5hcHAsIHRoaXMuYXBwLnJvdGF0ZVdvcmxkLCAneicsIC0wLjAxKSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLk5VTUJFUl8xOlxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0SW50ZXJ2YWxGdW5jdGlvbih0aGlzLmFwcCwgdGhpcy5hcHAucm90YXRlV29ybGQsICd6JywgMC4wMSkoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgS2V5Q29kZS5OVU1CRVJfOTpcbiAgICAgICAgICAgICAgICB0aGlzLmdldEludGVydmFsRnVuY3Rpb24odGhpcy5hcHAsIHRoaXMuYXBwLnJvdGF0ZVdvcmxkLCAneicsIC0wLjAxKSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLk5VTUJFUl8zOlxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0SW50ZXJ2YWxGdW5jdGlvbih0aGlzLmFwcCwgdGhpcy5hcHAucm90YXRlV29ybGQsICd6JywgMC4wMSkoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgS2V5Q29kZS5OVU1QQURfQUREOlxuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnpvb21JbigpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLk5VTVBBRF9TVUJUUkFDVDpcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC56b29tT3V0KCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEtleUNvZGUuTlVNUEFEX0VOVEVSOlxuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnpvb21PdXQoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgS2V5Q29kZS5OVU1CRVJfMDpcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC5yZXNldCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLlc6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEtleUNvZGUuUzpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgS2V5Q29kZS5BOlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLkQ6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbmtleXVwKGV2ZW50KSB7XG4gICAgICAgIHN3aXRjaCAoZXZlbnQua2V5Q29kZSkge1xuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLkVTQ0FQRTpcbiAgICAgICAgICAgICAgICBjb25zb2xlLmNsZWFyKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgS2V5Q29kZS5TUEFDRTpcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hcHAuZ3VpLmNsb3NlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcC5ndWkub3BlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAuZ3VpLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIEtleUNvZGUuVVA6XG4gICAgICAgICAgICBjYXNlIEtleUNvZGUuRE9XTjpcbiAgICAgICAgICAgIGNhc2UgS2V5Q29kZS5MRUZUOlxuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLlJJR0hUOlxuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLlBBR0VfVVA6XG4gICAgICAgICAgICBjYXNlIEtleUNvZGUuUEFHRV9ET1dOOlxuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLk5VTUJFUl80OlxuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLk5VTUJFUl82OlxuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLk5VTUJFUl84OlxuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLk5VTUJFUl8yOlxuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLk5VTUJFUl83OlxuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLk5VTUJFUl8xOlxuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLk5VTUJFUl85OlxuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLk5VTUJFUl8zOlxuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLk5VTVBBRF9BREQ6XG4gICAgICAgICAgICBjYXNlIEtleUNvZGUuTlVNUEFEX1NVQlRSQUNUOlxuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLlc6XG4gICAgICAgICAgICBjYXNlIEtleUNvZGUuUzpcbiAgICAgICAgICAgIGNhc2UgS2V5Q29kZS5BOlxuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLkQ6XG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhckludGVyRnVuY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSBLZXlDb2RlLkJBQ0tTUEFDRTpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9tYXAvcGJmL2xvYWQvaW5kZXguanMiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcHAge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmluaXRpYWxpemUoKTtcbiAgICAgICAgdGhpcy5sb2FkUGJmKCk7XG4gICAgICAgIHRoaXMubG9hZFZlY3RvcigpO1xuICAgIH1cblxuICAgIGluaXRpYWxpemUoKSB7XG4gICAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKTtcbiAgICAgICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjYW52YXMnLCBjYW52YXMpO1xuICAgICAgICBjb25zb2xlLmxvZygnY3R4JywgY3R4KTtcbiAgICB9XG5cbiAgICBsb2FkUGJmKCkge1xuICAgICAgICB0aGlzLmxvYWQoXG4gICAgICAgICAgICAnLi8uLi8uLi8uLi9hc3NldC9jb3VudHJpZXMvMC8wLzAucGJmJyxcbiAgICAgICAgICAgICh4aHR0cCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBiZiA9IG5ldyBQYmYobmV3IFVpbnQ4QXJyYXkoeGh0dHAucmVzcG9uc2UpKTtcbiAgICAgICAgICAgICAgICAvLyBjb25zdCB0aWxlID0gbmV3IFZlY3RvclRpbGUocGJmKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncGJmJywgcGJmKTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygndGlsZScsIHRpbGUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICh4aHR0cCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHhodHRwLnN0YXR1c1RleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH1cblxuICAgIGxvYWRWZWN0b3IoKSB7XG4gICAgICAgIHRoaXMubG9hZChcbiAgICAgICAgICAgICdodHRwczovL3RpbGUubWFwemVuLmNvbS9tYXB6ZW4vdmVjdG9yL3YxL2FsbC8xMy8xMzA4LzMxNjUubXZ0P2FwaV9rZXk9dmVjdG9yLXRpbGVzLUxNMjV0cTQnLFxuICAgICAgICAgICAgLy8gJ2h0dHBzOi8vdGlsZS5tYXB6ZW4uY29tL21hcHplbi92ZWN0b3IvdjEvYWxsLzEzLzEzMDkvMzE2NS5tdnQ/YXBpX2tleT12ZWN0b3ItdGlsZXMtTE0yNXRxNCcsXG4gICAgICAgICAgICAvLyAnaHR0cHM6Ly90aWxlLm1hcHplbi5jb20vbWFwemVuL3ZlY3Rvci92MS9hbGwvMTMvMTMxMC8zMTY1Lm12dD9hcGlfa2V5PXZlY3Rvci10aWxlcy1MTTI1dHE0JyxcbiAgICAgICAgICAgIC8vICdodHRwczovL3RpbGUubWFwemVuLmNvbS9tYXB6ZW4vdmVjdG9yL3YxL2FsbC8xMy8xMzExLzMxNjUubXZ0P2FwaV9rZXk9dmVjdG9yLXRpbGVzLUxNMjV0cTQnLFxuICAgICAgICAgICAgLy8gJ2h0dHBzOi8vdGlsZS5tYXB6ZW4uY29tL21hcHplbi92ZWN0b3IvdjEvYWxsLzEzLzEzMDgvMzE2Ni5tdnQ/YXBpX2tleT12ZWN0b3ItdGlsZXMtTE0yNXRxNCcsXG4gICAgICAgICAgICAvLyAnaHR0cHM6Ly90aWxlLm1hcHplbi5jb20vbWFwemVuL3ZlY3Rvci92MS9hbGwvMTMvMTMwOS8zMTY2Lm12dD9hcGlfa2V5PXZlY3Rvci10aWxlcy1MTTI1dHE0JyxcbiAgICAgICAgICAgIC8vICdodHRwczovL3RpbGUubWFwemVuLmNvbS9tYXB6ZW4vdmVjdG9yL3YxL2FsbC8xMy8xMzEwLzMxNjYubXZ0P2FwaV9rZXk9dmVjdG9yLXRpbGVzLUxNMjV0cTQnLFxuICAgICAgICAgICAgLy8gJ2h0dHBzOi8vdGlsZS5tYXB6ZW4uY29tL21hcHplbi92ZWN0b3IvdjEvYWxsLzEzLzEzMTEvMzE2Ni5tdnQ/YXBpX2tleT12ZWN0b3ItdGlsZXMtTE0yNXRxNCcsXG4gICAgICAgICAgICAvLyAnaHR0cHM6Ly90aWxlLm1hcHplbi5jb20vbWFwemVuL3ZlY3Rvci92MS9hbGwvMTMvMTMwOC8zMTY3Lm12dD9hcGlfa2V5PXZlY3Rvci10aWxlcy1MTTI1dHE0JyxcbiAgICAgICAgICAgIC8vICdodHRwczovL3RpbGUubWFwemVuLmNvbS9tYXB6ZW4vdmVjdG9yL3YxL2FsbC8xMy8xMzA5LzMxNjcubXZ0P2FwaV9rZXk9dmVjdG9yLXRpbGVzLUxNMjV0cTQnLFxuICAgICAgICAgICAgKHhodHRwKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGJmID0gbmV3IFBiZihuZXcgVWludDhBcnJheSh4aHR0cC5yZXNwb25zZSkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRpbGUgPSBuZXcgVmVjdG9yVGlsZShwYmYpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdwYmYnLCBwYmYpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0aWxlJywgdGlsZSk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCB6b29tID0gMTA7XG4gICAgICAgICAgICAgICAgY29uc3QgbGF5ZXJzID0gWyd3YXRlcicsICdsYW5kdXNlJywgJ3JvYWRzJywgJ2J1aWxkaW5ncyddO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGtleSBpbiB0aWxlLmxheWVycykge1xuICAgICAgICAgICAgICAgICAgICBkYXRhW2tleV0gPSB0aWxlLmxheWVyc1trZXldLnRvR2VvSlNPTigpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IGZlYXR1cmVzID0gW107XG5cbiAgICAgICAgICAgICAgICBsYXllcnMuZm9yRWFjaChcbiAgICAgICAgICAgICAgICAgICAgKGxheWVyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVtsYXllcl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpIGluIGRhdGFbbGF5ZXJdLmZlYXR1cmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIERvbid0IGluY2x1ZGUgYW55IGxhYmVsIHBsYWNlbWVudCBwb2ludHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFbbGF5ZXJdLmZlYXR1cmVzW2ldLnByb3BlcnRpZXMubGFiZWxfcGxhY2VtZW50KSB7IGNvbnRpbnVlIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEb24ndCBzaG93IGxhcmdlIGJ1aWxkaW5ncyBhdCB6MTMgb3IgYmVsb3cuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh6b29tIDw9IDEzICYmIGxheWVyID09ICdidWlsZGluZ3MnKSB7IGNvbnRpbnVlIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEb24ndCBzaG93IHNtYWxsIGJ1aWxkaW5ncyBhdCB6MTQgb3IgYmVsb3cuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh6b29tIDw9IDE0ICYmIGxheWVyID09ICdidWlsZGluZ3MnICYmIGRhdGFbbGF5ZXJdLmZlYXR1cmVzW2ldLnByb3BlcnRpZXMuYXJlYSA8IDIwMDApIHsgY29udGludWUgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFbbGF5ZXJdLmZlYXR1cmVzW2ldLmxheWVyX25hbWUgPSBsYXllcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVyZXMucHVzaChkYXRhW2xheWVyXS5mZWF0dXJlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZGF0YScsIGRhdGEpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmZWF0dXJlcycsIGZlYXR1cmVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBsb2FkKHVybCwgc3VjY2VzcyA9IG51bGwsIGVycm9yID0gbnVsbCkge1xuICAgICAgICBjb25zdCB4aHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICB4aHR0cC5vcGVuKCdHRVQnLCB1cmwpO1xuICAgICAgICB4aHR0cC5yZXNwb25zZVR5cGUgPSAnYXJyYXlidWZmZXInO1xuICAgICAgICB4aHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAoeGh0dHAucmVhZHlTdGF0ZSA9PSA0ICYmIHhodHRwLnN0YXR1cyA9PSAyMDApIHtcbiAgICAgICAgICAgICAgICBpZiAoc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzLmNhbGwobnVsbCwgeGh0dHApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgeGh0dHAub25lcnJvciA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGVycm9yLmNhbGwobnVsbCwgeGh0dHApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB4aHR0cC5zZW5kKCk7XG4gICAgfVxuXG4gICAgcmVzaXplKCkge1xuICAgIH1cbn1cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9tYXAvcGJmL2xvYWQvQXBwLmpzIl0sInNvdXJjZVJvb3QiOiIifQ==